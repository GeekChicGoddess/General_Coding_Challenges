<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Password Generator</title>
</head>
<body>

    <div><p>Your new password is:</p><p id="passwordResult"></p></div>
    <form name="passwordGenerator">


    </form>

<script>
"use strict";
(function(){

var length = 15;
var numberOfSpecialChar = 10;
var numberOfDigits = null;
var uppercase = false;
var lowercase = false;
var passwordArray = [];
var specialCharacterCounter = 0;
var digitsCounter = 0;
var lengthCounter = 0;
var randomAscii = 0;
var passwordChar = "";
var returnedPassword = [];



function generateIt() {

    if ((numberOfDigits + numberOfSpecialChar) > length) {
        console.log("The number of special characters plus the number of digits cannot exceed the length of the password");
    }
    else {

            while (lengthCounter < length) { // do this until we have as many characters as user asked for
                randomAscii = Math.floor(Math.random() * (126 - 33 + 1) + 33); // generate a number between 33 and 126 (inclusive)
                console.log(randomAscii);

                if (!uppercase) { // if user doesn't want uppercase, clear variable to 0 based on ascii range
                    if (randomAscii >= 65 && randomAscii <= 90) {
                        randomAscii = 0;
                    }
                }
                if (!lowercase) { // if user doesn't want lowercase, clear variable to 0 based on ascii range
                    if (randomAscii >= 97 && randomAscii <= 122) {
                        randomAscii = 0;
                    }
                }
                if (randomAscii >= 48 && randomAscii <= 57) {

                    if (numberOfDigits !== null) {
                        if ((numberOfDigits === 0) || (digitsCounter == numberOfDigits)) {
                            randomAscii = 0;
                        }
                    else {
                            digitsCounter++;
                            console.log("digicounter " + digitsCounter + " asci " + randomAscii);
                        }
                    }
                }
                if ((randomAscii >= 33 && randomAscii <= 47) || (randomAscii >= 91 && randomAscii <= 96) ||
                    (randomAscii >= 123 && randomAscii <= 126) || (randomAscii >= 58 && randomAscii <= 64)) {

                    if (numberOfSpecialChar !== null) {
                        if ((numberOfSpecialChar === 0) || (specialCharacterCounter == numberOfSpecialChar)) {
                            randomAscii = 0;
                        }
                        else {
                            specialCharacterCounter++;
                            console.log("spcounter " + specialCharacterCounter + " ascii " + randomAscii);
                        }

                    }
                }

                if (randomAscii) {
                    console.log("pushing " + randomAscii);
                    passwordArray.push(randomAscii); // acceptable numbers are pushed to array
                    lengthCounter++ // increast the length counter upon success
                }
            }
            console.log(passwordArray);


            if ((numberOfDigits) && (digitsCounter < numberOfDigits)) {
                var moreDigitsNeeded = numberOfDigits - digitsCounter;
                console.log("need more digits ");
                console.log(moreDigitsNeeded);

                var moreDigitsCounter = 0;
                var replacementascii = 0;
                var indexCounter = 0;
                while (moreDigitsCounter < moreDigitsNeeded) {

                    if (passwordArray[indexCounter] < 48 || passwordArray[indexCounter] > 57) {
                        if ((passwordArray[indexCounter] >= 33 && passwordArray[indexCounter] <= 47) || (passwordArray[indexCounter] >= 91 && passwordArray[indexCounter] <= 96) ||
                            (passwordArray[indexCounter] >= 123 && passwordArray[indexCounter] <= 126) || (passwordArray[indexCounter] >= 58 && passwordArray[indexCounter] <= 64)){
                            specialCharacterCounter--;
                            console.log("sp down " + specialCharacterCounter);
                        }
                        replacementascii = Math.floor(Math.random() * (57 - 48 + 1) + 48);
                        passwordArray.splice(indexCounter, 1, replacementascii);
                        moreDigitsCounter++;
                        digitsCounter++;
                        console.log("replacement " + replacementascii);


                    }
                    indexCounter++;
                }
            }



            if ((numberOfSpecialChar) && (specialCharacterCounter < numberOfSpecialChar)) {
                var moreSpecialCharNeeded = numberOfSpecialChar - specialCharacterCounter;
                var moreSpecialCharCounter = 0;
                var replacementascii = 0;
                var indexCounter = 0;
                console.log("We don't have enough special characers " + passwordArray);
                while (moreSpecialCharCounter < moreSpecialCharNeeded) {

                    if ((passwordArray[indexCounter] < 33 || passwordArray[indexCounter] > 47) && (passwordArray[indexCounter] < 91 || passwordArray[indexCounter] > 96) &&
                        (passwordArray[indexCounter] < 123 || passwordArray[indexCounter] > 126) && (passwordArray[indexCounter] < 58 || passwordArray[indexCounter] > 64)) {
                        if (passwordArray[indexCounter] >= 48 && passwordArray[indexCounter] <= 57) {
                            digitsCounter--;
                        }
                        replacementascii = Math.floor(Math.random() * (47 - 33 + 1) + 33);
                        passwordArray.splice(indexCounter, 1, replacementascii);
                        moreSpecialCharCounter++;
                        specialCharacterCounter++;
                        console.log("replacement " + replacementascii);

                    }
                    indexCounter++;
                }
            }

        }

        if  (((numberOfDigits) && (digitsCounter < numberOfDigits)) || ((numberOfSpecialChar) && (specialCharacterCounter < numberOfSpecialChar)) ) {
            if ((numberOfDigits) && (digitsCounter < numberOfDigits)) {
                var moreDigitsNeeded = numberOfDigits - digitsCounter;
                var moreDigitsCounter = 0;
                var replacementascii = 0;
                var indexCounter = 0;
                console.log("We don't have enough digits " + passwordArray);
                while (moreDigitsCounter < moreDigitsNeeded) {

                    if ((passwordArray[indexCounter] < 48 || passwordArray[indexCounter] > 57) && (passwordArray[indexCounter] < 33 || passwordArray[indexCounter] > 47) && (passwordArray[indexCounter] < 91 || passwordArray[indexCounter] > 96) &&
                        (passwordArray[indexCounter] < 123 || passwordArray[indexCounter] > 126) && (passwordArray[indexCounter] < 58 || passwordArray[indexCounter] > 64)) {
                        replacementascii = Math.floor(Math.random() * (57 - 48 + 1) + 48);
                        passwordArray.splice(indexCounter, 1, replacementascii);
                        moreDigitsCounter++;
                        console.log("replacement " + replacementascii);
                    }
                    indexCounter++;
                }
            }


            if ((numberOfSpecialChar) && (specialCharacterCounter < numberOfSpecialChar)) {
                var moreSpecialCharNeeded = numberOfSpecialChar - specialCharacterCounter;
                var moreSpecialCharCounter = 0;
                var replacementascii = 0;
                var indexCounter = 0;
                console.log("We don't have enough special characers " + passwordArray);
                while (moreSpecialCharCounter < moreSpecialCharNeeded) {

                    if ((passwordArray[indexCounter] < 48 || passwordArray[indexCounter] > 57) && (passwordArray[indexCounter] < 33 || passwordArray[indexCounter] > 47) && (passwordArray[indexCounter] < 91 || passwordArray[indexCounter] > 96) &&
                        (passwordArray[indexCounter] < 123 || passwordArray[indexCounter] > 126) && (passwordArray[indexCounter] < 58 || passwordArray[indexCounter] > 64)) {
                        replacementascii = Math.floor(Math.random() * (47 - 33 + 1) + 33);
                        passwordArray.splice(indexCounter, 1, replacementascii);
                        moreSpecialCharCounter++;
                        console.log("replacement " + replacementascii);

                    }
                    indexCounter++;
                }
            }






        }


        console.log(passwordArray);
    for(var i = 0; i < passwordArray.length; i++){
        passwordChar = String.fromCharCode(passwordArray[i]);
        returnedPassword.push(passwordChar);
    }
    console.log(returnedPassword);
    returnedPassword = returnedPassword.join("");
    console.log(returnedPassword);
    return returnedPassword;

}



generateIt();
//  passwordChar = String.fromCharCode(randomAscii);
    // uppcase if number >=65 && <=90
    // lowercase if number >=97  && <= 122
    // special characters 33-47, 64, 91-96, 123-126
    // digits 48-57
})();
</script>
</body>
</html>